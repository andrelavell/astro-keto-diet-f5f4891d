---
import { SITE } from "~/site.config";
const year = new Date().getFullYear();
const twitterHandle = SITE.authorTwitter;
const twitterUrl = twitterHandle ? `https://twitter.com/${twitterHandle.replace('@', '')}` : null;
import { getCollection } from 'astro:content';
const posts = await getCollection('blog', ({ data }) => import.meta.env.DEV || data.draft === false);
const categories = Array.from(new Set(posts.map((p) => p.data.category).filter(Boolean))).slice(0, 6) as string[];
---
<footer class="mt-20 border-t border-zinc-200/70 bg-zinc-50/50 py-14 dark:border-zinc-800 dark:bg-zinc-900/30">
  <div class="container grid grid-cols-1 gap-10 sm:grid-cols-2 lg:grid-cols-5">
    <div class="lg:col-span-2">
      <a href="/" class="flex items-center gap-3">
        <img src="/favicon.svg" alt="" class="h-8 w-8" />
        <span class="text-lg font-semibold tracking-tight">{SITE.title}</span>
      </a>
      <p class="mt-3 max-w-prose text-sm text-zinc-600 dark:text-zinc-400">{SITE.description}</p>
    </div>

    {categories.length > 0 && (
      <div>
        <h3 class="mb-3 text-xs font-semibold uppercase tracking-wider text-zinc-500">Categories</h3>
        <ul class="space-y-2 text-sm">
          {categories.map((c) => (
            <li><a href={`/categories/${encodeURIComponent(c)}`} class="hover:underline">{c}</a></li>
          ))}
          <li class="mt-1"><a href="/categories" class="text-zinc-500 hover:underline">All categories →</a></li>
        </ul>
      </div>
    )}

    <div>
      <h3 class="mb-3 text-xs font-semibold uppercase tracking-wider text-zinc-500">Site</h3>
      <ul class="space-y-2 text-sm">
        <li><a href="/" class="hover:underline">Home</a></li>
        <li><a href="/categories" class="hover:underline">Categories</a></li>
        <li><a href="/about" class="hover:underline">About</a></li>
      </ul>
    </div>

    <div>
      <h3 class="mb-3 text-xs font-semibold uppercase tracking-wider text-zinc-500">Resources</h3>
      <ul class="space-y-2 text-sm">
        <li><a href="/privacy" class="hover:underline">Privacy Policy</a></li>
        <li><a href="/terms" class="hover:underline">Terms of Service</a></li>
        <li><a href="/cookies" class="hover:underline">Cookie Policy</a></li>
        <li><a href="/disclaimer" class="hover:underline">Disclaimer</a></li>
      </ul>
    </div>

    <div>
      <h3 class="mb-3 text-xs font-semibold uppercase tracking-wider text-zinc-500">Follow</h3>
      <ul class="space-y-2 text-sm">
        {twitterUrl && <li><a href={twitterUrl} target="_blank" rel="noopener" class="hover:underline">{SITE.authorTwitter}</a></li>}
      </ul>
    </div>
  </div>

  <div class="container mt-10 flex flex-col justify-between gap-4 border-t border-zinc-200/70 pt-6 text-sm text-zinc-500 dark:border-zinc-800 sm:flex-row">
    <p>© {year} {SITE.author}. All rights reserved.</p>
    <div class="flex items-center gap-4">
      <a href="/rss.xml" class="hover:underline">RSS</a>
      <a href="/sitemap-index.xml" class="hover:underline">Sitemap</a>
      <a href="https://astro.build" target="_blank" rel="noopener" class="hover:underline">Astro</a>
    </div>
  </div>
</footer>
